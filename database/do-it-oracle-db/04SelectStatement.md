# 실무에서 가장 많이 사용하는 SQL, 조회



> 이 문서는 [<Do It! 오라클로 배우는 데이터베이스 입문>](http://www.kyobobook.co.kr/product/detailViewKor.laf?ejkGb=KOR&mallGb=KOR&barcode=9791163030300&orderClick=LEa&Kc=) 책을 보고 정리한 문서입니다.



## 1. SELECT문의 기본 형식

### 1.1. 실습용 테이블

- SQL문을 작성할 때 테이블 이름과 열 이름은 대문자로 쓰기를 권장함.
- SQL문은 대소문자 구분하지 않음. 프로그래밍 언어와 구분하고 가독성을 높이기 위해 실무에서는 SQL문 전체를 대문자로 사용하는 경우가 많음.



#### EMP 테이블

- EMP는 employee 약어이며 사원 데이터를 보관 및 관리하는 테이블.
  - EMPNO 사원 번호
  - ENAME 사원 이름
  - JOB 사원 직책
  - MGR 직속 상관의 사원 번호
  - HIREDATE 입사일
  - SAL 급여
  - COMM 급여 외 추가 수당
  - DEPTNO 사원이 속한 부서 번호



#### DEPT 테이블

- DEPT는 department 약어이며 회사를 구성하는 부서 데이터를 관리하는 테이블.
  - DNAME 부서 이름
  - LOC 부서가 위치한 지역



#### SALGRADE 테이블

- SALGRADE는 EMP 테이블에서 관리하는 사원들의 급여와 관련된 테이블.
  - GRADE 급여 등급
  - LOSAL 급여 등급의 최소 급여액
  - HISAL 급여 등급의 최대 급여액



### 1.2. 데이터를 조회하는 방법

- 데이터베이스에 보관되어 있는 데이터를 조회하는 데 사용하는 SELECT문은 출력 데이터를 선정하는 방식에 따라 크게 세 가지 방식으로 나뉨



#### 셀렉션

- 셀렉션(selection) : 행 단위로 원하는 데이터를 조회하는 방식.
- 테이블 전체 데이터 중 몇몇 가로줄의 데이터만 선택할 때 사용함.
- 예시 : 학생 중 졸업한 학생만 조회



#### 프로젝션

- 프로젝션(projection) : 열 단위로 원하는 데이터를 조회하는 방식.

- 예시 : 전체 학생 데이터에서 학번, 이름, 학과 코드만을 조회.



#### 셀렉션과 프로젝션 함께 사용하기

- 특정 테이블에서 조회하려는 행과 열을 모두 선별할 때 셀렉션과 프로젝션을 함께 사용할 수 있음.
- 예시 : 전체 학생 중 졸업생만을 조회하되 학번, 이름, 학과 코드 항목만 출력되도록 선택.



#### 조인

- 조인(join) : 두 개 이상의 테이블을 양옆에 연결하여 마치 하나의 테이블인 것처럼 데이터를 조회하는 방식.
- 외래키 등을 사용함.



### 1.3. SELECT절과 FROM절

- SELECT문은 데이터베이스에 보관되어 있는 데이터를 조회하는 데 사용함.
- SELECT문의 기본 구성은 SELECT절과 FROM절

- `SELECT [필드명] FROM [테이블명];`
- SELECT절
  - 조회할 열을 지정함.
  - 조회할 열 이름 또는 출력할 데이터를 하나 이상 지정 또는 애스터리스크(*)로 전체 열을 지정.
- FROM절
  - 조회할 테이블을 지정함.
  - 조회할 테이블 이름.
- 문장 끝에 세미콜론(;) 넣어야 함.



#### 전체 열 출력하기

- `SELECT * FROM EMP;`
- 결과 화면에 모든 데이터 표시됨.



#### 부분 열 출력하기

- EMP 테이블에서 사원 번호, 이름, 사원이 속한 부서 번호만 조회하기.

```
SELECT EMPNO, ENAME, DEPTNO
	FROM EMP;
```

- 띄어쓰기와 줄바꿈을 적극 활용할 것이 권장됨.



### 1.4. 중복 데이터를 삭제하는 DISTINCT

- SELECT문으로 데이터를 조회한 후 DISTINCT를 사용하여 중복을 제거.
- DISTINCT는 SELECT절에 열 이름을 명시하기 전에 선택적으로 사용 가능.

- 조회한 데이터의 내용에서 불필요한 중복을 제거하고 특정 데이터 종류만 확인하고 싶을 때 유용함.



#### 열이 한 개인 경우

```
SELECT DISTINCT DEPTNO
    FROM EMP;
```

- 명시한 열 중에서 같은 내용이 두 개 이상일 경우, 중복 행은 한 개만 남겨 두고 그 밖의 행은 모두 제거됨.



#### 열이 여러 개인 경우

```
SELECT DISTINCT JOB, DEPTNO
    FROM EMP;
```

- 결과를 보면 JOB 열의 값이 MANAGER인 데이터가 세 번 출력됨. MANAGER들의 DEPTNO가 모두 다르기 때문에 중복 데이터가 아니기 때문.
- JOB과 DEPTNO가 모두 중복된 데이터는 한 번만 출력됨.



#### ALL

```
SELECT ALL JOB, DEPTNO
    FROM EMP;
```

- ALL은 DISTINCT와 반대로 데이터 중복을 제거하지 않고 그대로 출력.
- SELECT절에서 중복 설정이 없을 경우에 ALL을 기본으로 사용함.



### 1.5. 별칭 설정하기

- SQL문에서는 최종 출력되는 열 이름을 임의로 지정할 수 있음.
- 본래 열 이름 대신 붙이는 이름을 별칭(alias)이라고 함.



#### 열과 연산식

```
01	SELECT ENAME, SAL, SAL*12+COMM, COMM
02		FROM EMP;
```

- SAL*12+COMM = '연간 총 수입'
- 연산식이 그대로 열 이름으로 출력되지 않게 짧고 간단한 다른 이름을 정할 때 별칭을 사용함.



#### 별칭 지정 방법

- SAL*12+COMM ANNSAL
- SAL*12+COMM "ANNSAL"
- SAL*12+COMM AS ANNSAL
- SAL*12+COMM AS "ANNSAL"



#### 실무에서의 별칭 지정

- 'AS'가 붙는 형식 + 쌍따옴표를 쓰지 않는 형식을 실무에서 선호함.
- AS 써야 어떤 단어가 별칭인지 알아보기 편함.

- 자바에서 SQL 쓰기

  - ```java
    String sql = "SELECT ENAME, SAL, SAL*12+COMM AS ANNSAL, COMM FROM EMP";
    ```

  - 별칭 지정에 쌍따옴표를 쓰다보면 자바에서 오류나 예외 발생할 수 있음.



### 1.6. ORDER BY

- 데이터를 정렬된 상태로 출력하기 위해 ORDER BY절을 사용.
- SELECT문을 작성할 때 사용할 수 있는 여러 절 중 가장 마지막 부분에 씀.



#### 오름차순 사용하기

- ASC. 기본값이라 안써도 됨.



#### 내림차순 사용하기

- DESC. 기본값 아니라서 내림차순 쓸려면 꼭 써줘야 함.

```
SELECT *
    FROM EMP
ORDER BY SAL DESC;
```



#### 내림차순과 올림차순 동시 사용

- 이중정렬이라고 함.
- ORDER BY절에는 우선순위를 고려하여 여러 개의 정렬 기준을 지정할 수 있음.
- 부서 번호 오름차순 -> 부서 번호가 같은 사원일 경우 급여 기준으로 내림차순 정렬

```
SELECT *
    FROM EMP
ORDER BY DEPTNO ASC, SAL DESC;
```



#### 사용할 때 주의사항

- 사용할 때 리소스 많이 잡아 먹기 때문에 꼭 필요할 때만 사용.



